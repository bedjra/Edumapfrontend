<div class="container">
  <h2>Entrer les informations de l'√©l√®ve si disponible !</h2>

  <!-- Progress Indicator -->
  <div class="progress-container">
    <div class="step" [class.active]="currentStep === 1" [class.completed]="currentStep > 1">1</div>
    <div class="line" [class.completed]="currentStep > 1"></div>
    <div class="step" [class.active]="currentStep === 2" [class.completed]="currentStep > 2">2</div>
    <div class="line" [class.completed]="currentStep > 2"></div>
    <div class="step" [class.active]="currentStep === 3">3</div>
  </div>

  <form id="studentForm" (ngSubmit)="submitForm()" #studentForm="ngForm" novalidate>

    <!-- √âtape 1: Informations personnelles -->
    <div class="form-step" [class.active]="currentStep === 1" id="step-content-1">
      <div class="form-row">
        <div class="form-group">
          <label for="nom">Nom</label>
          <input
            type="text"
            id="nom"
            name="nom"
            placeholder="Entrer le nom"
            class="form-control"
            required
            [(ngModel)]="eleve.nom"
            #nom="ngModel"
          />
          <div class="error-message" *ngIf="formSoumis && nom.invalid">Le nom est requis</div>
        </div>

        <div class="form-group">
          <label for="prenoms">Pr√©noms</label>
          <input
            type="text"
            id="prenoms"
            name="prenoms"
            placeholder="Entrer le pr√©nom"
            class="form-control"
            required
            [(ngModel)]="eleve.prenom"
            #prenoms="ngModel"
          />
          <div class="error-message" *ngIf="formSoumis && prenoms.invalid">Le pr√©nom est requis</div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="dateNaissance">Date de naissance</label>
          <input
            type="date"
            id="dateNaissance"
            name="dateNaissance"
            class="form-control"
            required
            [(ngModel)]="eleve.dateNaiss"
            #dateNaiss="ngModel"
          />
          <div class="error-message" *ngIf="formSoumis && dateNaiss.invalid">La date de naissance est requise</div>
        </div>

        <div class="form-group">
          <label for="lieuNaissance">Lieu de Naissance</label>
          <input
            type="text"
            id="lieuNaissance"
            name="lieuNaissance"
            placeholder="Entrer le lieu"
            class="form-control"
            required
            [(ngModel)]="eleve.lieuNais"
            #lieuNais="ngModel"
          />
          <div class="error-message" *ngIf="formSoumis && lieuNais.invalid">Le lieu de naissance est requis</div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="adresse">Adresse</label>
          <input
            type="text"
            id="adresse"
            name="adresse"
            placeholder="Entrer l'adresse"
            class="form-control"
            required
            [(ngModel)]="eleve.adresse"
            #adresse="ngModel"
          />
          <div class="error-message" *ngIf="formSoumis && adresse.invalid">L'adresse est requise</div>
        </div>

        <div class="form-group">
          <label>Sexe</label>
          <div class="radio-group">
            <label class="radio-label">
              <input
                type="radio"
                name="sexe"
                value="M"
                required
                [(ngModel)]="eleve.sexe"
                #sexe="ngModel"
              />
              <span>Masculin</span>
            </label>
            <label class="radio-label">
              <input
                type="radio"
                name="sexe"
                value="F"
                required
                [(ngModel)]="eleve.sexe"
                #sexe="ngModel"
              />
              <span>F√©minin</span>
            </label>
          </div>
          <div class="error-message" *ngIf="formSoumis && sexe.invalid">Le sexe est requis</div>
        </div>
      </div>
    </div>

    <!-- √âtape 2: Scolarit√© -->
    <div class="form-step" [class.active]="currentStep === 2" id="step-content-2">
      <div class="form-row">
        <div class="form-group">
          <label for="nationalite">Nationalit√©</label>
          <input
            type="text"
            id="nationalite"
            name="nationalite"
            class="form-control"
            placeholder="Ex. : Togolaise, S√©n√©galaise, Fran√ßaise..."
            required
            [(ngModel)]="eleve.nationalite"
            #nationalite="ngModel"
          />
          <div class="error-message" *ngIf="formSoumis && nationalite.invalid">La nationalit√© est requise</div>
        </div>

        <div class="form-group">
          <label for="classe">Classe</label>
          <select
            id="classe"
            name="classe"
            class="form-control"
            required
            [(ngModel)]="eleve.classe"
            #classe="ngModel"
          >
            <option value="">-- S√©lectionner la classe --</option>
            <option value="CP1">CP1</option>
            <option value="CP2">CP2</option>
            <option value="CE1">CE1</option>
            <option value="CE2">CE2</option>
            <option value="CM1">CM1</option>
            <option value="CM2">CM2</option>
          </select>
          <div class="error-message" *ngIf="formSoumis && classe.invalid">La classe est requise</div>
        </div>
      </div>

      <div class="form-row align-items-end">
        <div class="form-group flex-grow-1">
          <label for="tuteurAssigne">Tuteur assign√©</label>
          <select
            id="tuteurAssigne"
            class="form-control"
            name="tuteurAssigne"
            required
            [(ngModel)]="tuteurSelectionne"
            [disabled]="afficherFormTuteur"
            #tuteurSelect="ngModel"
          >
            <option value="" disabled>-- S√©lectionner un tuteur --</option>
            <option *ngFor="let tuteur of tuteurs" [value]="tuteur.id">
              {{ tuteur.nom }} {{ tuteur.prenom }}
            </option>
          </select>
          <div
            class="error-message"
            *ngIf="formSoumis && !tuteurSelectionne && !afficherFormTuteur"
          >
            Le tuteur assign√© est requis
          </div>
        </div>

        <div class="form-group mt-4" style="margin-top: -80px;">
          <br />
          <button
            type="button"
            class="btn btn-outline-primary btn-sm"
            (click)="basculerFormTuteur()"
          >
            {{ afficherFormTuteur ? '‚úñ Annuler' : '‚ûï Nouveau tuteur' }}
          </button>
        </div>
      </div>

      <div *ngIf="afficherFormTuteur" class="nouveau-tuteur-form mt-3 p-3 border rounded bg-light">
        <div class="form-row">
          <div class="form-group">
            <label>Nom</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="eleve.tuteurNom"
              name="nouveauTuteurNom"
            />
          </div>

          <div class="form-group">
            <label>Pr√©nom</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="eleve.tuteurPrenom"
              name="nouveauTuteurPrenom"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>T√©l√©phone</label>
            <input
              type="tel"
              class="form-control"
              [(ngModel)]="eleve.tuteurTelephone"
              name="nouveauTuteurTel"
            />
          </div>

          <div class="form-group">
            <label>Profession</label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="eleve.tuteurProfession"
              name="nouveauTuteurProfession"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- √âtape 3: Photo et confirmation -->
    <div class="form-step" [class.active]="currentStep === 3" id="step-content-3">
      <div class="summary">
        <h4>üìã R√©sum√© des informations</h4>

        <div class="summary-row">
          <div class="summary-label">Nom</div>
          <div class="summary-value">{{ eleve.nom }}</div>
        </div>
        <div class="summary-row">
          <div class="summary-label">Pr√©nom</div>
          <div class="summary-value">{{ eleve.prenom }}</div>
        </div>
        <div class="summary-row">
          <div class="summary-label">Date de naissance</div>
          <div class="summary-value">{{ eleve.dateNaiss | date }}</div>
        </div>
        <div class="summary-row">
          <div class="summary-label">Lieu de naissance</div>
          <div class="summary-value">{{ eleve.lieuNais }}</div>
        </div>
        <div class="summary-row">
          <div class="summary-label">Adresse</div>
          <div class="summary-value">{{ eleve.adresse }}</div>
        </div>
        <div class="summary-row">
          <div class="summary-label">Sexe</div>
          <div class="summary-value">
            {{ eleve.sexe === 'M' ? 'Masculin' : 'F√©minin' }}
          </div>
        </div>
        <div class="summary-row">
          <div class="summary-label">Nationalit√©</div>
          <div class="summary-value">{{ eleve.nationalite }}</div>
        </div>
        <div class="summary-row">
          <div class="summary-label">Classe</div>
          <div class="summary-value">{{ eleve.classe }}</div>
        </div>
        <div class="summary-row" *ngIf="afficherFormTuteur">
          <div class="summary-label">Nouveau tuteur</div>
          <div class="summary-value">
            {{ eleve.tuteurNom }} {{ eleve.tuteurPrenom }} - {{ eleve.tuteurTelephone }} - {{ eleve.tuteurProfession }}
          </div>
        </div>
        

        
      </div>
    </div>

    <!-- Navigation buttons -->
    <div class="form-navigation mt-4 d-flex justify-content-between">
      <button
        type="button"
        class="btn btn-secondary"
        (click)="prevStep()"
        [disabled]="currentStep === 1"
      >
        Pr√©c√©dent
      </button>

      <button
        type="button"
        class="btn btn-primary"
        (click)="nextStep()"
        *ngIf="currentStep < 3"
      >
        Suivant
      </button>

      <button
        type="submit"
        class="btn btn-success"
        *ngIf="currentStep === 3"
      >
        Soumettre
      </button>
    </div>
  </form>
</div>
