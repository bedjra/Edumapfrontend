<div class="container">
    <h2>Entrer les informations et la photo de l'√©l√®ve si disponible !</h2>

    <!-- Progress Indicator -->
    <div class="progress-container">
        <div class="step" [class.active]="currentStep === 1" [class.completed]="currentStep > 1">1</div>
        <div class="line" [class.completed]="currentStep > 1"></div>
        <div class="step" [class.active]="currentStep === 2" [class.completed]="currentStep > 2">2</div>
        <div class="line" [class.completed]="currentStep > 2"></div>
        <div class="step" [class.active]="currentStep === 3">3</div>
    </div>


    <form id="studentForm">

        <!-- √âtape 1: Informations personnelles -->
        <div class="form-step active" [class.active]="currentStep === 1" id="step-content-1">

            <div class="form-row">
                <div class="form-group">
                    <label for="nom">Nom</label>
                    <input type="text" id="nom" name="nom" placeholder="Entrer le nom" class="form-control" required>
                    <div class="error-message" id="nom-error">Le nom est requis</div>
                </div>

                <div class="form-group">
                    <label for="prenoms">Pr√©noms</label>
                    <input type="text" id="prenoms" name="prenoms" placeholder="Entrer le pr√©nom" class="form-control"
                        required>
                    <div class="error-message" id="prenoms-error">Le pr√©nom est requis</div>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="dateNaissance">Date de naissance</label>
                    <input type="date" id="dateNaissance" name="dateNaissance" class="form-control" required>
                    <div class="error-message" id="dateNaissance-error">La date de naissance est requise</div>
                </div>

                <div class="form-group">
                    <label for="lieuNaissance">Lieu de Naissance</label>
                    <input type="text" id="lieuNaissance" name="lieuNaissance" placeholder="Entrer le lieu"
                        class="form-control" required>
                    <div class="error-message" id="lieuNaissance-error">Le lieu de naissance est requis</div>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="nationalite">Nationalit√©</label>
                    <select id="nationalite" name="nationalite" class="form-control" required>
                        <option value="">Choisir la nationalit√©</option>
                        <option value="francaise">Fran√ßaise</option>
                        <option value="belge">Belge</option>
                        <option value="suisse">Suisse</option>
                        <option value="canadienne">Canadienne</option>
                        <option value="ivoirienne">Ivoirienne</option>
                        <option value="senegalaise">S√©n√©galaise</option>
                        <option value="autre">Autre</option>
                    </select>
                    <div class="error-message" id="nationalite-error">La nationalit√© est requise</div>
                </div>

                <div class="form-group">
                    <label>Sexe</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="sexe" value="masculin" required>
                            <span>Masculin</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="sexe" value="feminin" required>
                            <span>F√©minin</span>
                        </label>
                    </div>
                    <div class="error-message" id="sexe-error">Le sexe est requis</div>
                </div>
            </div>
        </div>

        <!-- √âtape 2: Scolarit√© -->
        <div class="form-step" [class.active]="currentStep === 2" id="step-content-2">
            <div class="form-row">
                <div class="form-group">
                    <label for="ecoleProvenance">√âcole de provenance</label>
                    <input type="text" id="ecoleProvenance" name="ecoleProvenance" placeholder="Entrer l'√©cole"
                        class="form-control" required [(ngModel)]="etudiant.etblProv" />
                    <div class="error-message" *ngIf="formSoumis && !etudiant.etblProv">L'√©cole de provenance est
                        requise</div>
                </div>

                <div class="form-group">
                    <label for="classe">Classe</label>
                    <select id="classe" name="classe" class="form-control" required [(ngModel)]="etudiant.classe">
                        <option value="">-- S√©lectionner la classe --</option>
                        <option value="CP1">CP1</option>
                        <option value="CP2">CP2</option>
                        <option value="CE1">CE1</option>
                        <option value="CE2">CE2</option>
                        <option value="CM1">CM1</option>
                        <option value="CM2">CM2</option>
                        <option value="3eme">3√®me</option>
                    </select>
                    <div class="error-message" *ngIf="formSoumis && !etudiant.classe">La classe est requise</div>
                </div>
            </div>

            <div class="form-group d-flex align-items-center gap-2">
                <div class="flex-grow-1">
                    <label for="tuteurAssigne">Tuteur assign√©</label>
                    <select id="tuteurAssigne" class="form-control" [(ngModel)]="tuteurSelectionne" name="tuteurAssigne"
                        required>
                        <option value="" disabled selected>-- S√©lectionner un tuteur --</option>
                        <option *ngFor="let tuteur of tuteurs" [value]="tuteur.id">
                            {{ tuteur.nom }} {{ tuteur.prenom }}
                        </option>
                    </select>
                </div>

                <div class="mt-4">
                    <button type="button" class="btn btn-outline-primary btn-sm"
                        (click)="afficherFormTuteur = !afficherFormTuteur">
                        ‚ûï Nouveau tuteur
                    </button>
                </div>
            </div>

            <div class="error-message" *ngIf="formSoumis && !tuteurSelectionne">
                Le tuteur assign√© est requis
            </div>

            <!-- Formulaire dynamique du nouveau tuteur -->
            <div *ngIf="afficherFormTuteur" class="nouveau-tuteur-form mt-3 p-3 border rounded bg-light">
                <h6 class="mb-3">üßæ Nouveau Tuteur</h6>

                <div class="form-group">
                    <label>Nom</label>
                    <input type="text" class="form-control" [(ngModel)]="nouveauTuteur.nom" name="nouveauTuteurNom" />
                </div>

                <div class="form-group">
                    <label>Pr√©nom</label>
                    <input type="text" class="form-control" [(ngModel)]="nouveauTuteur.prenom"
                        name="nouveauTuteurPrenom" />
                </div>

                <div class="form-group">
                    <label>T√©l√©phone</label>
                    <input type="tel" class="form-control" [(ngModel)]="nouveauTuteur.telephone"
                        name="nouveauTuteurTel" />
                </div>

                <div class="form-group">
                    <label>Profession</label>
                    <input type="text" class="form-control" [(ngModel)]="nouveauTuteur.profession"
                        name="nouveauTuteurProfession" />
                </div>
            </div>
        </div>

        <!-- √âtape 3: Photo et confirmation -->
        <div class="form-step" [class.active]="currentStep === 3" id="step-content-3">


            <!-- R√©sum√© des informations -->
            <div class="summary">
                <h4>üìã R√©sum√© des informations</h4>
                <div class="summary-item">
                    <strong>Nom:</strong> <span id="summary-nom">Non renseign√©</span>
                </div>
                <div class="summary-item">
                    <strong>Pr√©nom:</strong> <span id="summary-prenoms">Non renseign√©</span>
                </div>
                <div class="summary-item">
                    <strong>Date de naissance:</strong> <span id="summary-dateNaissance">Non renseign√©e</span>
                </div>
                <div class="summary-item">
                    <strong>Lieu de naissance:</strong> <span id="summary-lieuNaissance">Non renseign√©</span>
                </div>
                <div class="summary-item">
                    <strong>Nationalit√©:</strong> <span id="summary-nationalite">Non renseign√©e</span>
                </div>
                <div class="summary-item">
                    <strong>Sexe:</strong> <span id="summary-sexe">Non renseign√©</span>
                </div>
                <div class="summary-item">
                    <strong>√âcole:</strong> <span id="summary-ecoleProvenance">Non renseign√©e</span>
                </div>
                <div class="summary-item">
                    <strong>Classe:</strong> <span id="summary-classe">Non renseign√©e</span>
                </div>
                <div class="summary-item">
                    <strong>Tuteur:</strong> <span id="summary-tuteurAssigne">Non renseign√©</span>
                </div>
            </div>
        </div>


        <!-- Boutons de navigation -->
<div class="button-container">
  <!-- Pr√©c√©dent visible uniquement si ce n‚Äôest pas le premier step -->
  <button type="button" class="btn btn-secondary" *ngIf="currentStep > 1" (click)="goToPreviousStep()">‚Üê Pr√©c√©dent</button>

  <!-- Suivant visible uniquement si on n‚Äôest pas au dernier step -->
  <button type="button" class="btn btn-primary" *ngIf="currentStep < totalSteps" 
    [disabled]="!validateCurrentStep()" (click)="goToNextStep()">Suivant ‚Üí</button>

  <!-- Enregistrer visible uniquement si on est au dernier step -->
  <button type="submit" class="btn btn-success" *ngIf="currentStep === totalSteps">
    ‚úÖ Enregistrer
    <div class="loading" *ngIf="loadingVisible"></div>
  </button>
</div>



    </form>
</div>